# 2_Intermediate_test_2
## Часть 1: Обзор данных
### Загрузите датасет в кликхаус и проведите предварительный обзор данных. Не забудьте, что необходимо удалить те столбцы, которые в схеме не отображены.  
С помощью Docker compose создан контейнер, в который установлена СУБД ClickHouse и скопирован исходный файл с данными в формате csv.  
Для инициализации базы данных и таблицы в файл init.sql были добавлены команды и выполнены шаги:
1. создана база данных
2. создана таблица в соответствие с исходным файлом данных
3. с помощью команды INSERT INTO FROM INFILE импортированы данные в формате csv
4. Удалены ненужные столбцы

При предварительном анализе данных установлено всего два местоположения вакансий: Москва и Санкт-Петербург

### Разбейте таблицу с кучей вакансий на нескольких витрин по местоположению, чтобы не нагружать одну таблицу. 
### Удалите те вакансии, в которых не указана заработная плата.
С помощью команд  
__CREATE TABLE IF NOT EXISTS .. AS SELECT__
создано две новые таблицы для каждого местоположения.
Строки с неуказанной зарплатой были исключены добавленным условием
__WHERE Area = .. AND Salary__

## Часть 2: Извлечение информации
### Напишите код для извлечения информации о средней заработной плате вакансий и местоположении, 
### где вакансии наиболее распространены. Выведите это все в один отчет.
С помощью объединенных запросов:
__SELECT  
  'Москва' AS "Местоположение",  
  COUNT(*) AS "Количество вакансий",  
  ROUND(AVG("From")) AS "Средняя минимальная зарплата",  
  ROUND(AVG("To")) AS "Средняя максимальная зарплата"  
FROM hr.vac_msk  
  UNION ALL  
SELECT  
  'Санкт-Петербург' AS "Местоположение",  
  COUNT(*) AS "Количество вакансий",  
  ROUND(AVG("From")) AS "Средняя минимальная зарплата",  
  ROUND(AVG("To")) AS "Средняя максимальная зарплата"  
FROM hr.vac_spb;__

___Получаем результат:___  
| Местоположение | Количество вакансий | Средняя зп от, руб | Средняя зп до, руб |  
|----------------|---------------------|--------------------|--------------------|
| Москва	       |               11530 |           111344.0 |	          162775.0 |  
| Санкт-Петербург|	              6052 |            94034.0 |	          137345.0 |
